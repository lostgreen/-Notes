# 故障恢复

## 故障的终结和恢复协议

- **终结协议**——若分布式事务的某个节点故障，其他节点也应该终结，协议规定正在运行的节点如何处理该事务故障
- **恢复协议**——规定出故障的节点相应进程（协调者或参与者）如何在事务重启后恢复数据库的状态。
- 恢复协议和终结协议之间的关系：非阻塞的终结协议，未必意味着独立的恢复协议；独立的恢复协议，却一定意味着非阻塞终结协议

```example
3PC场景：
参与者A在PreCommit后崩溃
- 终结过程不会阻塞（非阻塞特性）
- 但A恢复时需要询问其他节点最终决定（非独立恢复）

假设协议P具有独立恢复特性：
1. 节点A崩溃时本地记录了足够信息
2. A恢复时可独立决定提交或回滚
   => 说明终结过程中A也能独立决策
   => 因此P必然是非阻塞的
```
